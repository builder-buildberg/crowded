
<!-- extends the base.html file -->
{% extends 'base.html' %}
{% load static %}

<!-- title block -->
{% block title %}Grounds{% endblock %}
{% block header %}
    {% include 'ground/header.html' %}
{% endblock %}

<!-- content block for the list of grounds -->
{% block content %}
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <section>
    <div class="py-5">
    <div class="container">
        <!-- give the search bar a class of search-bar and margin of 10px inside the container -->  
        <div class="search-bar" style="margin-bottom:20px; display: flex; align-items:center; ">
            <input type="text" id="pac-input" class="form-control" placeholder="Search for Grounds and Locations">
        </div>
        
        <div id="list" class="row hidden-md-up">
          {% for ground in object_list %}
            <div class=" col-md-4">
                <div id="ground_card" class="card" onclick="document.location='{% url 'ground_detail' ground.id %}'">
                    <img src="{{ ground.image.url }}" class="card-img-top" alt="...">
                    <div class="card-body">
                        <h5 class="card-title">{{ ground.name }}</h5>
                        <a class="list-group-item"><i class='bx bx-map'></i> {{ground.area}}, {{ground.city}}</a>
                        <a class="list-group-item"><i class='bx bx-money'></i> Rs. {{ground.price}} per hour</a>
                        <a id="view_details" href="{% url 'ground_detail' ground.id %}" class="btn btn-primary" style="width:100%; margin-top:8px;">View Details</a>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
{% endblock %}

<!-- footer block -->
{% block footer %}
<a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>
{% include 'footer.html' %}
{% endblock %}

<!-- scripts block -->
{% block scripts %}
    
    <script>
        var input1 = document.getElementById("pac-input");
        input1.addEventListener("keyup", function(event) {
        if (event.keyCode === 13) {
            event.preventDefault();
            document.getElementById("pac-input").blur();
        }
        });

        const data = "{{qs_json}}"
        const qs = JSON.parse(data.replace(/&quot;/g, '"'))
        console.log(qs)
        const input = document.getElementById("pac-input");
        let filteredArray = []
        input.addEventListener("keyup",(e)=>{
            list.innerHTML = ""
            filteredArray = qs.filter(ground => ground.name.toLowerCase().includes(e.target.value.toLowerCase()) || ground.should_also_be_shown_in.toLowerCase().includes(e.target.value.toLowerCase()))
            // filteredArray = filteredArray.concat(qs.filter(ground => ground.should_also_be_shown_in.toLowerCase().includes(e.target.value.toLowerCase())))
            if (filteredArray.length == 0){
                list.innerHTML = "<h1 style='text-align: center;'>No Grounds Found</h1>"
            }

            else {
                // list.innerHTML = `<p><strong>${filteredArray.length} Grounds Found</strong></p>'
                filteredArray.forEach(ground => {
                    list.innerHTML += `
                    <div class=" col-md-4">
                        <div id="ground_card" class="card" onclick="document.location='/ground/${ground.id}'">
                    <img src="media/${ground.image}" class="card-img-top" alt="...">
                    <div class="card-body">
                        <h5 class="card-title">${ground.name}</h5>
                        <a class="list-group-item"><i class='bx bx-map'></i> ${ground.area}, ${ground.city}</a>
                        <a class="list-group-item"><i class='bx bx-money'></i> Rs. ${ground.price} per hour</a>
                        <a id="view_details" href="/ground/${ground.id}" class="btn btn-primary" style="width:100%; margin-top:8px;" >View Details</a>
                    </div>
                </div>
            </div>`
        })
            }
        })    
    </script>
   
{% endblock %}
</section>
